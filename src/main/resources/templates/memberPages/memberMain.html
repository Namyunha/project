<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <th:block th:replace="/component/config::config"></th:block>
    <link rel="stylesheet" href="/css/mypage.css">
</head>
<body>
<th:block th:replace="/component/header::header"></th:block>
<body>

<div id="container">
    <div id="selectArea" class="flex-shrink-0 p-3" style="width: 280px;">
        <a href="/" class="d-flex align-items-center pb-3 mb-3 link-body-emphasis text-decoration-none border-bottom">
            <svg class="bi pe-none me-2" width="30" height="24">
                <use xlink:href="#bootstrap"></use>
            </svg>
            <span class="fs-5 fw-semibold">마이페이지</span>
        </a>
        <ul class="list-unstyled ps-0">
            <li id="manageProfile" class="mb-1">
                <button id="manageProfile_title"
                        class="btn btn-toggle d-inline-flex align-items-center rounded border-0 collapsed"
                        data-bs-toggle="collapse" data-bs-target="#home-collapse" aria-expanded="false">
                    프로필
                </button>
                <div class="collapse manageProfile_option" id="home-collapse" style="">
                    <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
                        <li>
                            <button onclick="checkUser()"
                                    class="link-body-emphasis d-inline-flex text-decoration-none rounded">확인하기
                            </button>
                        </li>
                        <li>
                            <button onclick="updateUser()"
                                    class="link-body-emphasis d-inline-flex text-decoration-none rounded">수정하기
                            </button>
                        </li>
                    </ul>
                </div>
            </li>
            <li id="manageLocation" class="mb-1">
                <button id="manageLocation_title"
                        class="btn btn-toggle d-inline-flex align-items-center rounded border-0 collapsed"
                        data-bs-toggle="collapse" data-bs-target="#dashboard-collapse" aria-expanded="false">
                    모임장소관리
                </button>
                <div class="collapse manageLocation_option" id="dashboard-collapse" style="">
                    <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
                        <li><a href="#" class="link-body-emphasis d-inline-flex text-decoration-none rounded">예약내역</a>
                        </li>
                    </ul>
                </div>
            </li>
            <li id="manageCounsel" class="mb-1">
                <button id="manageCounsel_title"
                        class="btn btn-toggle d-inline-flex align-items-center rounded border-0 collapsed"
                        data-bs-toggle="collapse" data-bs-target="#orders-collapse" aria-expanded="false">
                    문의신청내역
                </button>
            </li>

            <li class="mb-1">
                <button class="btn btn-toggle d-inline-flex align-items-center rounded border-0 collapsed"
                        data-bs-toggle="collapse" data-bs-target="#account-collapse" aria-expanded="false">
                    탈퇴하기
                </button>
            </li>
        </ul>
    </div>

    <div id="viewArea">
        <table>
            <tbody>
            <tr>
                <th>회원번호</th>
                <td><input type="text" th:value="${loginUser.id}"></td>
            </tr>
            <tr>
                <th>아이디</th>
                <td><input type="text" th:value="${loginUser.memberId}"></td>
            </tr>
            <tr>
                <th>비밀번호</th>
                <td><input type="text" th:value="${loginUser.memberPass}"></td>
            </tr>
            <tr>
                <th>이름</th>
                <td><input type="text" th:value="${loginUser.memberName}"></td>
            </tr>
            <tr>
                <th>생년월일</th>
                <td><input type="text" th:value="${loginUser.memberPrivate}"></td>
            </tr>
            <tr>
                <th>성별</th>
                <td><input type="text" th:value="${loginUser.memberGender}"></td>
            </tr>
            <tr>
                <th>이메일</th>
                <td><input type="text" th:value="${loginUser.memberGender}"></td>
            </tr>
            <tr>
                <th>휴대번호</th>
                <td><input type="text" th:value="${loginUser.memberPhone}"></td>
            </tr>
            </tbody>
        </table>
    </div>


</div>
<script>
    const checkUser = () => {
        const viewArea = document.querySelector("#viewArea");
        const id = "[[${loginUser.id}]]";
        axios({
            url: "/member/" + id,
            method: "get"
        }).then(res => {
            const loginUser = res.data; // 서버에서 받아온 데이터를 loginUser 변수에 저장
            let result = "<table>\n" +
                "            <tbody>\n" +
                "            <tr>\n" +
                "                <th>회원번호</th>\n" +
                "                <td>" + loginUser.id + "</td>\n" +
                "            </tr>\n" +
                "            <tr>\n" +
                "                <th>아이디</th>\n" +
                "                <td>" + loginUser.memberId + "</td>\n" +
                "            </tr>\n" +
                "            <tr>\n" +
                "                <th>비밀번호</th>\n" +
                "                <td>" + loginUser.memberPass + "</td>\n" +
                "            </tr>\n" +
                "            <tr>\n" +
                "                <th>이름</th>\n" +
                "                <td>" + loginUser.memberName + "</td>\n" +
                "            </tr>\n" +
                "            <tr>\n" +
                "                <th>생년월일</th>\n" +
                "                <td>" + loginUser.memberPrivate + "</td>\n" +
                "            </tr>\n" +
                "            <tr>\n" +
                "                <th>성별</th>\n" +
                "                <td>" + loginUser.memberGender + "</td>\n" +
                "            </tr>\n" +
                "            <tr>\n" +
                "                <th>이메일</th>\n" +
                "                <td>" + loginUser.memberEmail + "</td>\n" +
                "            </tr>\n" +
                "            <tr>\n" +
                "                <th>휴대번호</th>\n" +
                "                <td>" + loginUser.memberPhone + "</td>\n" +
                "            </tr>\n" +
                "            </tbody>\n" +
                "        </table>";
            viewArea.innerHTML = result;
        }).catch(err => {
            alert("정보를 불러올 수 없습니다.");
        });
    };

    const updateUser = () => {
        const viewArea = document.querySelector("#viewArea");
        const id = "[[${loginUser.id}]]";
        axios({
            url: "/member/" + id,
            method: "get"
        }).then(res => {
            const loginUser = res.data; // 서버에서 받아온 데이터를 loginUser 변수에 저장
            let result = "<table>\n" +
                "            <tbody>\n" +
                "            <tr>\n" +
                "                <th>회원번호</th>\n" +
                "                <td><input type=\"text\" value=\"" + loginUser.id + "\"></td>\n" +
                "            </tr>\n" +
                "            <tr>\n" +
                "                <th>아이디</th>\n" +
                "                <td><input type=\"text\" value=\"" + loginUser.memberId + "\"></td>\n" +
                "            </tr>\n" +
                "            <tr>\n" +
                "                <th>비밀번호</th>\n" +
                "                <td><input type=\"text\" value=\"" + loginUser.memberPass + "\"></td>\n" +
                "            </tr>\n" +
                "            <tr>\n" +
                "                <th>이름</th>\n" +
                "                <td><input type=\"text\" value=\"" + loginUser.memberName + "\"></td>\n" +
                "            </tr>\n" +
                "            <tr>\n" +
                "                <th>생년월일</th>\n" +
                "                <td><input type=\"text\" value=\"" + loginUser.memberPrivate + "\"></td>\n" +
                "            </tr>\n" +
                "            <tr>\n" +
                "                <th>성별</th>\n" +
                "                <td><input type=\"text\" value=\"" + loginUser.memberGender + "\"></td>\n" +
                "            </tr>\n" +
                "            <tr>\n" +
                "                <th>이메일</th>\n" +
                "                <td><input type=\"text\" value=\"" + loginUser.memberEmail + "\"></td>\n" +
                "            </tr>\n" +
                "            <tr>\n" +
                "                <th>휴대번호</th>\n" +
                "                <td><input type=\"text\" value=\"" + loginUser.memberPhone + "\"></td>\n" +
                "            </tr>\n" +
                "            </tbody>\n" +
                "        </table>" +
                "<td><button onclick='goUpdate()'>수정하기</button></td>";
            viewArea.innerHTML = result;
        }).catch(err => {
            alert("업데이트가 불가합니다");
        });
    };

    const goUpdate = () => {
        const viewArea = document.querySelector("#viewArea");
        const id = "[[${loginUser.id}]]";
        const memberId = "[[${loginUser.memberId}]]";
        const memberPass = "[[${loginUser.memberId}]]";
        const memberName = "[[${loginUser.memberName}]]";
        const memberPrivate = "[[${loginUser.memberPrivate}]]";
        const memberGender = "[[${loginUser.memberGender}]]";
        const memberEmail = "[[${loginUser.memberEmail}]]";

        axios({
            url: "/member/" + id,
            method: "put"
        }).then(res => {

        }).catch(err => {

        })
    }

</script>
</html>